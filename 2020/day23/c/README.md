To solve this in any reasonable time, you'll need to use a hashmap